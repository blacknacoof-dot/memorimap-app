
import { createClient } from '@supabase/supabase-js';
import * as path from 'path';
import * as dotenv from 'dotenv';
import axios from 'axios';

const envPath = path.resolve(process.cwd(), '.env.local');
dotenv.config({ path: envPath });

const supabaseUrl = process.env.VITE_SUPABASE_URL || '';
const supabaseServiceKey = process.env.VITE_SUPABASE_SERVICE_ROLE_KEY || '';
const supabase = createClient(supabaseUrl, supabaseServiceKey);

const NAVER_CLIENT_ID = process.env.VITE_NAVER_CLIENT_ID || '';
const NAVER_CLIENT_SECRET = process.env.VITE_NAVER_CLIENT_SECRET || '';
const KAKAO_API_KEY = process.env.VITE_KAKAO_REST_API_KEY || '';

const RAW_TEXT = `ë´‰ì•ˆì‹œì„¤
ëŒ€í•œë¶ˆêµì •ìŒì‚¬ì›
ì¶©ì²­ë¶ë„ ì²­ì£¼ì‹œ ì„œì›êµ¬ 3ìˆœí™˜ë¡œ644ë²ˆê¸¸ 33 (ì£½ë¦¼ë™, ëŒ€í•œë¶ˆêµì •ìŒì‚¬ì›)
â˜… 0
(0)

íŒŒì£¼ì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
íŒŒì£¼ì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ê²½ê¸°ë„ íŒŒì£¼ì‹œ íŒŒì£¼ì ì•½ìˆ˜ê³¨ê¸¸ 67 (ì—°í’ë¦¬)
â˜… 0
(0)

ë§Œì¸ì‚° ë§Œì¸ì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ë§Œì¸ì‚° ë§Œì¸ì‚¬ ë´‰ì•ˆë‹¹
ì¶©ì²­ë‚¨ë„ ê¸ˆì‚°êµ° ë³µìˆ˜ë©´ ë‹¤ë³µë¡œ 525-35 (ìš©ì§„ë¦¬, ë§Œì¸ì‚¬)
â˜… 0
(0)

ì•½ì‚¬ì‚¬ì§€ì¥ì „ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ì•½ì‚¬ì‚¬ì§€ì¥ì „ì¶”ëª¨ê´€
ì¸ì²œê´‘ì—­ì‹œ ë‚¨ë™êµ¬ í’€ë¬´ë¡œ 48 (ê°„ì„ë™)
â˜… 0
(0)

ì²œì£¼êµ ê¸ˆìƒë™ì„±ë‹¹ í•˜ëŠ˜ìë¦¬
ë´‰ì•ˆì‹œì„¤
ì²œì£¼êµ ê¸ˆìƒë™ì„±ë‹¹ í•˜ëŠ˜ìë¦¬
ì „ë¼ë¶ë„ ì „ì£¼ì‹œ ë•ì§„êµ¬ ì „ì§„ë¡œ 107-13 (ê¸ˆìƒë™)
â˜… 0
(0)

ê´€ìŒì‚¬ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ê´€ìŒì‚¬ì¶”ëª¨ê´€
ì „ë¼ë‚¨ë„ ë‹´ì–‘êµ° ë‹´ì–‘ì ê¹Šì€ì‹¤ê¸¸ 35 (í•™ë™ë¦¬)
â˜… 0
(0)

ìƒì›”ì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ìƒì›”ì‚¬ ë´‰ì•ˆë‹¹
ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì–‘ì„±ë©´ ì²œë•ì‚°ë¡œ 919 (ë™í•­ë¦¬)
â˜… 0
(0)

êµ¬ë¯¸ì‹œê³µì„¤ìˆ­ì¡°ë‹¹ ì œ2ê´€
ë´‰ì•ˆì‹œì„¤
êµ¬ë¯¸ì‹œê³µì„¤ìˆ­ì¡°ë‹¹ ì œ2ê´€
ê²½ìƒë¶ë„ êµ¬ë¯¸ì‹œ ì˜¥ì„±ë©´ ì„ ìƒë™ë¡œ 419-1 (ì´ˆê³¡ë¦¬)
â˜… 0
(0)

ê´‘ì²œì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ê´‘ì²œì‚¬ ë´‰ì•ˆë‹¹
ê²½ìƒë‚¨ë„ ì–‘ì‚°ì‹œ í•˜ë¶ë©´ ë°±ë¡ë¡œ 116 (ë°±ë¡ë¦¬)
â˜… 0
(0)

ê²½ì‹ í•˜ëŠ˜ëœ°ê³µì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ê²½ì‹ í•˜ëŠ˜ëœ°ê³µì› ë´‰ì•ˆë‹¹
ê²½ê¸°ë„ ì–‘ì£¼ì‹œ ë‚¨ë©´ í™”í•©ë¡œ430ë²ˆê¸¸ 98(ê²½ì‹ ë¦¬, ê²½ì‹ í•˜ëŠ˜ëœ°ê³µì›)
â˜… 0
(0)

(ì£¼)ê´‘ë¦¼ê³µì› ë™ì‚°ê³µì›ë¬˜ì›(ë´‰ì•ˆ)
ë´‰ì•ˆì‹œì„¤
(ì£¼)ê´‘ë¦¼ê³µì› ë™ì‚°ê³µì›ë¬˜ì›(ë´‰ì•ˆ)
ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì¶˜ì²œì‹œ ë™ì‚°ë©´ ì¢…ìë¦¬ë¡œ 331-50 (êµ°ìë¦¬, ì¶˜ì²œì‹œê³µì„¤ë¬˜ì›)
â˜… 0
(0)

ìˆ˜ì•”ì‚¬ ì˜í˜¼ì˜ì‰¼í„°
ë´‰ì•ˆì‹œì„¤
ìˆ˜ì•”ì‚¬ ì˜í˜¼ì˜ì‰¼í„°
ê²½ìƒë‚¨ë„ ì˜ë ¹êµ° ì˜ë ¹ì ìˆ˜ì•”ë¡œ 267 (í•˜ë¦¬)
â˜… 0
(0)

ì˜¤í–¥ì¤‘í¥êµíšŒ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì˜¤í–¥ì¤‘í¥êµíšŒ ë´‰ì•ˆë‹¹
ê²½ê¸°ë„ ê´‘ì£¼ì‹œ ê³¤ì§€ì•”ì ê°€ë§ˆì„ê¸¸ 83-19 (ì˜¤í–¥ë¦¬)
â˜… 0
(0)

ì •ì„ í•˜ëŠ˜ì›
ë´‰ì•ˆì‹œì„¤
ì •ì„ í•˜ëŠ˜ì›
ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì •ì„ êµ° ì—¬ëŸ‰ë©´ ì„œë™ë¡œ 3867-26 (ë‚¨ê³¡ë¦¬, ì •ì„ í•˜ëŠ˜ê³µì›)
â˜… 0
(0)

ìƒìƒì¶”ëª¨ê³µì›
ë´‰ì•ˆì‹œì„¤
ìƒìƒì¶”ëª¨ê³µì›
ì „ë¼ë‚¨ë„ í•¨í‰êµ° í•¨í‰ì í•¨ì¥ë¡œ 933-43 (ìˆ˜í˜¸ë¦¬)
â˜… 0
(0)

ì„œëŒ€ì‚°ì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì„œëŒ€ì‚°ì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ì¶©ì²­ë‚¨ë„ ê¸ˆì‚°êµ° ì¶”ë¶€ë©´ ì„œëŒ€ë™ê¸°ê¸¸ 100 (ì„œëŒ€ë¦¬)
â˜… 0
(0)

ì§€ì¥ì •ì‚¬ ì—°í™”ëŒ€
ë´‰ì•ˆì‹œì„¤
ì§€ì¥ì •ì‚¬ ì—°í™”ëŒ€
ì¶©ì²­ë‚¨ë„ ë…¼ì‚°ì‹œ ë…¸ì„±ë©´ í™”ê³¡ì•ˆê¸¸ 103 (í™”ê³¡ë¦¬, ì§€ì¥ì •ì‚¬,í…œí”ŒìŠ¤í…Œì´,ì—°í™”ëŒ€,ë²•ë¥œì¢…ì¬ë‹¨)
â˜… 0
(0)

ë°€ì–‘ì„±ë‹¹ ì²œìƒë‚™ì›
ë´‰ì•ˆì‹œì„¤
ë°€ì–‘ì„±ë‹¹ ì²œìƒë‚™ì›
ê²½ìƒë‚¨ë„ ë°€ì–‘ì‹œ ë°€ì–‘ëŒ€ê³µì›ë¡œ 74 (êµë™)
â˜… 0
(0)

ê¹€í¬ì—°í™”ì‚¬ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ê¹€í¬ì—°í™”ì‚¬ì¶”ëª¨ê´€
ê²½ê¸°ë„ ê¹€í¬ì‹œ í•˜ì„±ë©´ ì—°í™”ë´‰ë¡œ 233 (í›„í‰ë¦¬)
â˜… 0
(0)

ë™íƒ„ë‚©ê³¨ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ë™íƒ„ë‚©ê³¨ì¶”ëª¨ê´€
ê²½ê¸°ë„ í™”ì„±ì‹œ ë™íƒ„ê¸°í¥ë¡œ 64-42 (ì†¡ë™, ë²•ì™•ì²­)
â˜… 0
(0)

ìˆœì²œì‹œë¦½ì¶”ëª¨ê³µì› 1ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ìˆœì²œì‹œë¦½ì¶”ëª¨ê³µì› 1ë´‰ì•ˆë‹¹
ì „ë¼ë‚¨ë„ ìˆœì²œì‹œ ì–‘ìœ¨ê¸¸ 132 (ì•¼í¥ë™)
â˜… 0
(0)

ë´‰ì€ì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ë´‰ì€ì‚¬ ë´‰ì•ˆë‹¹
ì¶©ì²­ë¶ë„ ì¶©ì£¼ì‹œ ì†Œíƒœë©´ ì£¼ì¹˜ê¸¸ 135-45 (ì˜¤ëŸ‰ë¦¬, ë´‰ì€ì‚¬)
â˜… 0
(0)

ì„±ë¶ˆì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì„±ë¶ˆì‚¬ ë´‰ì•ˆë‹¹
ì¶©ì²­ë‚¨ë„ ë…¼ì‚°ì‹œ ìƒì›”ë©´ ìƒì›”ë¡œ486ë²ˆê¸¸ 81 (ëŒ€ëª…ë¦¬)
â˜… 0
(0)

ì—°ê½ƒí”¼ìš°ëŠ” í–‰ë³µë„ëŸ‰ ìš©ë¬¸ì‚¬
ë´‰ì•ˆì‹œì„¤
ì—°ê½ƒí”¼ìš°ëŠ” í–‰ë³µë„ëŸ‰ ìš©ë¬¸ì‚¬
ê²½ê¸°ë„ ê¹€í¬ì‹œ ì›”ê³¶ë©´ ëŒ€ê³¶ë¡œ 570 (ê°ˆì‚°ë¦¬, ìš©ë¬¸ì‚¬)
â˜… 0
(0)

ì²œì£¼ì‚¬ ì˜íƒ‘ê³µì›
ë´‰ì•ˆì‹œì„¤
ì²œì£¼ì‚¬ ì˜íƒ‘ê³µì›
ê²½ìƒë¶ë„ ë¬¸ê²½ì‹œ ë™ë¡œë©´ ì²œì£¼ì‚¬ê¸¸ 108 (ê°„ì†¡ë¦¬, ì²œì£¼ì‚¬)
â˜… 0
(0)

ì°½ì›ì‹œë¦½ë§ˆì‚°ì˜ìƒì›
ë´‰ì•ˆì‹œì„¤
ì°½ì›ì‹œë¦½ë§ˆì‚°ì˜ìƒì›
ê²½ìƒë‚¨ë„ ì°½ì›ì‹œ ë§ˆì‚°í•©í¬êµ¬ ì§„ë™ë©´ ê³µì›ë¬˜ì›ë¡œ 136-106 (ì¸ê³¡ë¦¬, ì˜ìƒì›)
â˜… 0
(0)

ì•ˆí¥ë™ê³µì„¤ë¬˜ì§€(ë´‰ì•ˆì‹œì„¤)
ë´‰ì•ˆì‹œì„¤
ì•ˆí¥ë™ê³µì„¤ë¬˜ì§€(ë´‰ì•ˆì‹œì„¤)
ê²½ê¸°ë„ ë™ë‘ì²œì‹œ ì•ˆí¥ë™ ì‚°62
â˜… 0
(0)

ìš¸ë¦‰í•˜ëŠ˜ì„¬ê³µì›
ë´‰ì•ˆì‹œì„¤
ìš¸ë¦‰í•˜ëŠ˜ì„¬ê³µì›
ê²½ìƒë¶ë„ ìš¸ë¦‰êµ° ì„œë©´ íƒœí•˜ë ¹ê¸¸ 314 (ë‚¨ì„œë¦¬)
â˜… 0
(0)

í™”ì²œê³µì›ë¬˜ì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
í™”ì²œê³µì›ë¬˜ì› ë´‰ì•ˆë‹¹
ê°•ì›íŠ¹ë³„ìì¹˜ë„ í™”ì²œêµ° í•˜ë‚¨ë©´ ì›ì²œë¦¬ 9-13
â˜… 0
(0)

í•©ì²œì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
í•©ì²œì¶”ëª¨ê³µì› ë´‰ì•ˆë‹¹
ê²½ìƒë‚¨ë„ í•©ì²œêµ° í•©ì²œì í•©ì²œí˜¸ìˆ˜ë¡œ 1633 (í•©ì²œë¦¬)
â˜… 0
(0)

ê´‘ë¦‰ì¶”ëª¨ê³µì› ë´‰ì•ˆë¬˜
ë´‰ì•ˆì‹œì„¤
ê´‘ë¦‰ì¶”ëª¨ê³µì› ë´‰ì•ˆë¬˜
ê²½ê¸°ë„ í¬ì²œì‹œ ë‚´ì´Œë©´ ë¶€ë§ˆë¡œ 341 (ë§ˆëª…ë¦¬)
â˜… 0
(0)

í•˜ëŠ˜ë¬¸ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
í•˜ëŠ˜ë¬¸ ë´‰ì•ˆë‹¹
ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì–‘ì„±ë©´ ë¯¸ë¦¬ë‚´ì„±ì§€ë¡œ 386-27 (ë¯¸ì‚°ë¦¬, ë¯¸ë¦¬ë‚´ì‹¤ë²„íƒ€ìš´)
â˜… 0
(0)

ì¶”ëª¨ê´€ ì²œìƒì˜ì§‘
ë´‰ì•ˆì‹œì„¤
ì¶”ëª¨ê´€ ì²œìƒì˜ì§‘
ì „ë¼ë‚¨ë„ í•´ë‚¨êµ° í•´ë‚¨ì í•´ë‚¨ë¡œ 160-83 (ì‹ ì•ˆë¦¬, ì„ ê°ì‚¬)
â˜… 0
(0)

ì²œì£¼êµ ëŒ€êµ¬êµêµ¬ ì£½ë„ì„±ë‹¹
ë´‰ì•ˆì‹œì„¤
ì²œì£¼êµ ëŒ€êµ¬êµêµ¬ ì£½ë„ì„±ë‹¹
ê²½ìƒë¶ë„ í¬í•­ì‹œ ë¶êµ¬ ì£½ë„ë¡œ 20 (ì£½ë„ë™)
â˜… 0
(0)

êµ­ì›í•˜ëŠ˜ì •ì›
ë´‰ì•ˆì‹œì„¤
êµ­ì›í•˜ëŠ˜ì •ì›
ê²½ìƒë‚¨ë„ ì‚¬ì²œì‹œ ê³¤ëª…ë©´ ë§‰ê³¨ê¸¸ 267-195 (ë§ˆê³¡ë¦¬, ì€ì ë‚©ê³¨ê³µì›)
â˜… 0
(0)

ì§„ì£¼ë‚´ë™ê³µì›ë¬˜ì› ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì§„ì£¼ë‚´ë™ê³µì›ë¬˜ì› ë´‰ì•ˆë‹¹
ê²½ìƒë‚¨ë„ ì§„ì£¼ì‹œ ë‚´ë™ë©´ ìœ ìˆ˜ê¸¸75ë²ˆê¸¸ 8-214 (ìœ ìˆ˜ë¦¬, ì§„ì£¼ë‚´ë™ê³µë™ë¬˜ì›)
â˜… 0
(0)

ë¶ˆì¡°ì‚¬ íœ´ì•ˆì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ë¶ˆì¡°ì‚¬ íœ´ì•ˆì¶”ëª¨ê´€
ê²½ìƒë‚¨ë„ ê¹€í•´ì‹œ ìƒë™ë©´ ìƒë™ë¡œ 178-54 (ìš°ê³„ë¦¬, ë¶ˆì¡°ì‚¬)
â˜… 0
(0)

ê·¹ë½ì‚¬ì¶”ëª¨ì› í•˜ëŠ˜ì •ì›
ë´‰ì•ˆì‹œì„¤
ê·¹ë½ì‚¬ì¶”ëª¨ì› í•˜ëŠ˜ì •ì›
ê²½ìƒë¶ë„ ì¹ ê³¡êµ° ì§€ì²œë©´ ì°½í‰ë¡œ 415 (ì°½í‰ë¦¬)
â˜… 0
(0)

ê°œì›ì¶”ëª¨ê³µì› ë´‰ì•ˆíƒ‘
ë´‰ì•ˆì‹œì„¤
ê°œì›ì¶”ëª¨ê³µì› ë´‰ì•ˆíƒ‘
ê²½ìƒë¶ë„ ì˜ì²œì‹œ ì‹ ë…•ë©´ ì¥ìˆ˜ë¡œ 2238-28 (í™”ë‚¨ë¦¬)
â˜… 0
(0)

ì•ˆì •ì‚¬ ë‚©ê³¨ë‹¹
ë´‰ì•ˆì‹œì„¤
ì•ˆì •ì‚¬ ë‚©ê³¨ë‹¹
ê²½ìƒë‚¨ë„ í†µì˜ì‹œ ê´‘ë„ë©´ ì•ˆì •1ê¸¸ 363 (ì•ˆì •ë¦¬)
â˜… 0
(0)

ì§€ì¥ì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì§€ì¥ì‚¬ ë´‰ì•ˆë‹¹
ì „ë¼ë‚¨ë„ ë‚˜ì£¼ì‹œ ì™•ê³¡ë©´ ì‹ í¬ë‚´ë™ê¸¸ 14-29 (ì‹ í¬ë¦¬)
â˜… 0
(0)

í˜œëª…ì‚¬ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
í˜œëª…ì‚¬ ë´‰ì•ˆë‹¹
ì¶©ì²­ë‚¨ë„ ì•„ì‚°ì‹œ ì—¼ì¹˜ì ìŒì£½ê¸¸ 133-7 (ìŒì£½ë¦¬)
â˜… 0
(0)

ìš©ë´‰ì‚¬ ë‚©ê³¨ë‹¹
ë´‰ì•ˆì‹œì„¤
ìš©ë´‰ì‚¬ ë‚©ê³¨ë‹¹
ê²½ìƒë‚¨ë„ í†µì˜ì‹œ ê´‘ë„ë©´ í–¥êµì˜†ê¸¸ 71-26 (ì£½ë¦¼ë¦¬)
â˜… 0
(0)

ì •í†µë¶ˆêµì¡°ê³„ì¢… ì´ë³¸ì‚° ì„¸ì›ì‚¬
ë´‰ì•ˆì‹œì„¤
ì •í†µë¶ˆêµì¡°ê³„ì¢… ì´ë³¸ì‚° ì„¸ì›ì‚¬
ê²½ìƒë‚¨ë„ ì˜ë ¹êµ° ì¹ ê³¡ë©´ ì¹ ê³¡ë¡œ1ê¸¸ 56ì„¸ì›ì‚¬ (ë„ì‚°ë¦¬)
â˜… 0
(0)

ë¬´ëŸ‰ì‚¬ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ë¬´ëŸ‰ì‚¬ì¶”ëª¨ê´€
ê²½ìƒë¶ë„ í¬í•­ì‹œ ë¶êµ¬ í¥í•´ì ë™í•´ëŒ€ë¡œ1393ë²ˆê¸¸ 111-99 (ì´ˆê³¡ë¦¬)
â˜… 0
(0)

ê´‘ì£¼ì˜ë½ê³µì› ë´‰ì•ˆë‹´
ë´‰ì•ˆì‹œì„¤
ê´‘ì£¼ì˜ë½ê³µì› ë´‰ì•ˆë‹´
ê´‘ì£¼ê´‘ì—­ì‹œ ë¶êµ¬ íš¨ë ¹ë™ 100-2
â˜… 0
(0)

ëŒ€í•œë¶ˆêµì¡°ê³„ì¢… ë¬´ì¼ì„ ì›
ë´‰ì•ˆì‹œì„¤
ëŒ€í•œë¶ˆêµì¡°ê³„ì¢… ë¬´ì¼ì„ ì›
ê²½ìƒë¶ë„ ê²½ì£¼ì‹œ ê°í¬ì íšŒê³¡ê¸¸ 127(ëŒ€ë³¸ë¦¬, ê´€ìŒì‚¬)
â˜… 0
(0)

ê´‘ì£¼ì˜ë½ê³µì› ë´‰ì•ˆë¬˜
ë´‰ì•ˆì‹œì„¤
ê´‘ì£¼ì˜ë½ê³µì› ë´‰ì•ˆë¬˜
ê´‘ì£¼ê´‘ì—­ì‹œ ë¶êµ¬ íš¨ë ¹ë™ ì‚°47-1
â˜… 0
(0)

ê´€ìŒì‚¬ ì¶”ëª¨ê´€
ë´‰ì•ˆì‹œì„¤
ê´€ìŒì‚¬ ì¶”ëª¨ê´€
ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì›ì£¼ì‹œ í–‰êµ¬ë¡œ 533-3 (í–‰êµ¬ë™, ê´€ìŒì‚¬)
â˜… 0
(0)

ìš°ë„ë©´ ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ìš°ë„ë©´ ë´‰ì•ˆë‹¹
ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì œì£¼ì‹œ ìš°ë„ë©´ ì˜ì¼ê¸¸ 80-10 (ì—°í‰ë¦¬, ìš°ë„ì¥ë¡€ì‹ì¥)
â˜… 0
(0)

ì˜ì›”êµ° ë´‰ì•ˆë‹¹
ë´‰ì•ˆì‹œì„¤
ì˜ì›”êµ° ë´‰ì•ˆë‹¹
ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì˜ì›”êµ° ì£¼ì²œë©´ ì†”ì¹˜ë¡œ 240-120 (ì‹ ì¼ë¦¬)
â˜… 0
(0)

ì¥ìˆ˜ì•” ìì—°ì¥ì§€
ìì—°ì¥
ì¥ìˆ˜ì•” ìì—°ì¥ì§€
ê²½ìƒë‚¨ë„ ì°½ì›ì‹œ ë§ˆì‚°í•©í¬êµ¬ êµ¬ì‚°ë©´ ì›ì „1ê¸¸ 141 (ì‹¬ë¦¬, ì¥ìˆ˜ì•”)
â˜… 0
(0)

í¬í¬ì¦ˆ ë°˜ë ¤ë™ë¬¼ì¥ë¡€ì‹ì¥ ê¹€í¬ì 
ë™ë¬¼ì¥ë¬˜
í¬í¬ì¦ˆ ë°˜ë ¤ë™ë¬¼ì¥ë¡€ì‹ì¥ ê¹€í¬ì 
ê²½ê¸°ë„ ê¹€í¬ì‹œ ì›”ê³¶ë©´ ì• ê¸°ë´‰ë¡œ 262 í¬í¬ì¦ˆ ê¹€í¬ì 
â˜… 0
(0)

í«ë°”ë¼ê¸° ì¼ì‚°ì 
ë™ë¬¼ì¥ë¬˜
í«ë°”ë¼ê¸° ì¼ì‚°ì 
ê²½ê¸°ë„ ê³ ì–‘ì‹œ ì¼ì‚°ë™êµ¬ ì€ë§ˆê¸¸63ë²ˆê¸¸ 25-2 í«ë°”ë¼ê¸°
â˜… 0
(0)

ìš°ë¦¬í«
ë™ë¬¼ì¥ë¬˜
ìš°ë¦¬í«
ëŒ€êµ¬ê´‘ì—­ì‹œ ì„œêµ¬ ìƒˆë°©ë¡œ27ê¸¸ 39 3ì¸µ
â˜… 0
(0)

ì„œìš¸ì„±ëª¨ì¥ë¡€ì‹ì¥
ì¥ë¡€ì‹ì¥
ì„œìš¸ì„±ëª¨ì¥ë¡€ì‹ì¥
ì„œìš¸íŠ¹ë³„ì‹œ ì„œì´ˆêµ¬ ë°˜í¬ëŒ€ë¡œ 222 (ë°˜í¬ë™, ê°€í†¨ë¦­ëŒ€í•™êµì„±ì˜êµì •)
â˜… 4.78
(5)`;

async function getCoords(query: string) {
    if (!NAVER_CLIENT_ID) return null;
    try {
        const response = await axios.get('https://naveropenapi.apigw.ntruss.com/map-geocode/v2/geocode', {
            params: { query: query },
            headers: { 'X-NCP-APIGW-API-KEY-ID': NAVER_CLIENT_ID, 'X-NCP-APIGW-API-KEY': NAVER_CLIENT_SECRET }
        });
        if (response.data.addresses.length > 0) {
            const { x, y, roadAddress, jibunAddress } = response.data.addresses[0];
            return { lat: parseFloat(y), lng: parseFloat(x), address: roadAddress || jibunAddress };
        }
    } catch (e) { }

    // Fallback to Kakao
    if (!KAKAO_API_KEY) return null;
    try {
        const response = await axios.get('https://dapi.kakao.com/v2/local/search/address.json', {
            params: { query: query },
            headers: { Authorization: `KakaoAK ${KAKAO_API_KEY}` }
        });
        if (response.data.documents.length > 0) {
            const { y, x, address_name } = response.data.documents[0];
            return { lat: parseFloat(y), lng: parseFloat(x), address: address_name };
        }
    } catch (e) { }

    return null;
}

function parseText(text: string) {
    const list = [];
    const blocks = text.split('\n\n');
    for (const block of blocks) {
        let lines = block.split('\n').map(l => l.trim()).filter(l => l);
        if (lines.length < 3) continue;

        let rawType = '';
        let name = '';
        let address = '';

        // Check if Line 0 is Type Key
        const isLine0Type = ['ë´‰ì•ˆì‹œì„¤', 'ìì—°ì¥', 'ë™ë¬¼ì¥ë¬˜', 'ì¥ë¡€ì‹ì¥'].some(k => lines[0].includes(k));

        if (isLine0Type) {
            rawType = lines[0];
            name = lines[1];
            address = lines[2];
        } else {
            // Pattern: Name \n Type \n Name(Repeat) \n Address
            name = lines[0];
            rawType = lines[1];
            address = lines[3]; // Line 4
        }

        // Clean address
        if (address && address.startsWith('â˜…')) address = lines[lines.length - 3];
        // If address is undefined, try finding "ì‹œ "
        if (!address) {
            address = lines.find(l => l.includes('ì‹œ ') || l.includes('êµ° ') || l.includes('êµ¬ ')) || '';
        }

        let dbType = 'charnel'; // Default
        if (rawType.includes('ìì—°') || name.includes('ìˆ˜ëª©') || name.includes('ì”ë””') || rawType.includes('ìì—°ì¥')) dbType = 'natural';
        if (rawType.includes('ë™ë¬¼') || rawType.includes('í«') || name.includes('í¬í¬ì¦ˆ') || name.includes('í«')) dbType = 'pet';
        if (rawType.includes('ì¥ë¡€ì‹ì¥') || name.includes('ì¥ë¡€ì‹ì¥')) dbType = 'funeral';
        if (rawType.includes('ë´‰ì•ˆ')) dbType = 'charnel';

        if (name && address) {
            list.push({ name, address, type: dbType });
        }
    }
    return list;
}

async function main() {
    console.log("ğŸš€ ëŒ€ê·œëª¨ ì‹œì„¤ ì¶”ê°€ ë° ê²€ì¦ (Retry) ì‹œì‘...");

    const facilities = parseText(RAW_TEXT);
    console.log(`Parsed ${facilities.length} facilities.`);

    for (const fac of facilities) {
        // Only retry ones that failed? No, just run all, it's fast enough.
        console.log(`Processing [${fac.type}] ${fac.name}...`);
        console.log(`  Querying Address: "${fac.address}"`);

        const coords = await getCoords(fac.address);
        if (!coords) {
            console.log(`  âŒ Location not found: ${fac.address}`);
            continue;
        }

        console.log(`  ğŸ“ Found: ${coords.lat}, ${coords.lng}`);

        // Check exist
        const { data: existing } = await supabase
            .from('memorial_spaces')
            .select('id, name')
            .like('name', `%${fac.name.split('(')[0].trim()}%`)
            .maybeSingle();

        const payload = {
            name: fac.name,
            type: fac.type,
            address: coords.address,
            lat: coords.lat,
            lng: coords.lng,
            is_verified: true,
            data_source: 'user_bulk_extension',
            description: fac.type === 'pet' ? 'ë°˜ë ¤ë™ë¬¼ ì¥ë¡€ì‹ì¥' : (fac.type === 'funeral' ? 'ì¥ë¡€ì‹ì¥' : 'ì¶”ëª¨ì‹œì„¤'),
        };

        if (existing) {
            console.log(`  - Updating existing ID ${existing.id}`);
            await supabase.from('memorial_spaces').update(payload).eq('id', existing.id);
        } else {
            console.log(`  - Inserting new`);
            await supabase.from('memorial_spaces').insert(payload);
        }

        await new Promise(r => setTimeout(r, 100)); // Rate limit
    }
}

main();
